name: Add ready-to-merge label # if proper comment added

on: issue_comment

jobs:

  automerge:
    if: github.event.pull_request.draft == false && ${{ github.event.issue.pull_request }}
    runs-on: ubuntu-latest
    steps:
      - name: Parse comment
        id: comment-parse
        uses: actions/github-script@v5
        with:
          script: |
            const commentBody = context.payload.comment.body;
            
            if(contentBody === '/ready-to-merge') return true
      - name: Add label
        if: ${{ steps.comment-parse.outputs.result }} == 'true'
        uses: buildsville/add-remove-label@v1
        with:
          token: ${{secrets.GITHUB_TOKEN}}
          label: ready-to-merge
          type: add
